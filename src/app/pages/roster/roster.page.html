<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Roster</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="importCsv()">Import CSV</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <form
    [formGroup]="playerForm"
    (ngSubmit)="add()"
    class="form"
  >
    <ion-list
      lines="full"
      class="roster-form"
    >
      <ion-item>
        <ion-label position="stacked">Player First Name</ion-label>
        <ion-input
          formControlName="firstName"
          autocomplete="off"
          inputmode="text"
          required
        ></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Player Last Name</ion-label>
        <ion-input
          formControlName="lastName"
          autocomplete="off"
          inputmode="text"
          required
        ></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Jersey #</ion-label>
        <ion-input
          formControlName="jersey"
          type="number"
          inputmode="numeric"
          required
        ></ion-input>
      </ion-item>
    </ion-list>

    <!-- Add button below the form -->
    <ion-button
      type="submit"
      expand="block"
      class="ion-margin-top"
      [disabled]="playerForm.invalid"
    >
      Add
    </ion-button>
  </form>

  <section style="padding:12px;display:flex;gap:8px;">
    <ion-input
      placeholder="Player name"
      [(ngModel)]="name"
    ></ion-input>
    <ion-input
      placeholder="Jersey #"
      [(ngModel)]="number"
    ></ion-input>
    <ion-button (click)="add()">Add</ion-button>
    <ion-button
      fill="outline"
      (click)="toggleImport = !toggleImport"
    >Import CSV</ion-button>
  </section>

  @if(toggleImport) {
  <section style="padding:12px;">
    <p>Paste CSV lines: <code>name,number</code></p>
    <textarea
      [(ngModel)]="csv"
      rows="6"
      style="width:100%;"
    ></textarea>
    <div style="margin-top:8px;display:flex;gap:8px;">
      <ion-button (click)="importCsv()">Import</ion-button>
      <ion-button
        fill="clear"
        (click)="csv=''"
      >Clear</ion-button>
    </div>
  </section>
  }

  <ion-list>
    @for(p of players(); track p.number) {
    <ion-item>
      <ion-label>
        <h2>{{ p.name }}</h2>
        @if(p.number) {
        <p>#{{ p.number }}</p>
        }
      </ion-label>
      <ion-button
        slot="end"
        fill="outline"
        (click)="rename(p.id)"
      >Edit</ion-button>
      <ion-button
        slot="end"
        color="danger"
        (click)="remove(p.id)"
      >Delete</ion-button>
    </ion-item>
    }
  </ion-list>
</ion-content>